<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK Esports - Live Debug</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.344.0?bundle",
            "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
        }
    }
    </script>
</head>
<body class="bg-slate-950 text-white">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect } from 'react';
        import ReactDOM from 'react-dom/client';
        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';
        import { getFirestore, doc, setDoc, getDoc, onSnapshot } from 'firebase/firestore';

        // ============================================================
        // ðŸ”´ YAHAN APNI ASLI FIREBASE CONFIG PASTE KAREIN
        // ============================================================
        const firebaseConfig = {
  apiKey: "AIzaSyBJWklGdsRM_XNo2_4AUceUZsiIyIjbUBA",
  authDomain: "mk-esports-60429.firebaseapp.com",
  projectId: "mk-esports-60429",
  storageBucket: "mk-esports-60429.firebasestorage.app",
  messagingSenderId: "663019221754",
  appId: "1:663019221754:web:d75e59277feb0ac12a8f43",
  measurementId: "G-QJHXYR70RG"
};
       
        // ============================================================

        // --- LOGGER FUNCTION (Screen par dikhane ke liye) ---
        let logs = [];
        const addLog = (msg, type='info') => {
            console.log(msg);
            const time = new Date().toLocaleTimeString();
            logs = [`[${time}] ${msg}`, ...logs];
            const logBox = document.getElementById('log-box');
            if(logBox) logBox.innerHTML = logs.map(l => `<div class="mb-1 border-b border-gray-800 pb-1">${l}</div>`).join('');
        };

        // Initialize Firebase
        let auth, db;
        try {
            if (firebaseConfig.apiKey.includes("DUMMY")) {
                addLog("âš ï¸ Warning: Using DUMMY Config. Backend won't work.", "warn");
            }
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            addLog("âœ… Firebase Initialized. Ready to connect.");
        } catch (e) {
            addLog("âŒ Firebase Init Failed: " + e.message, "error");
        }

        function App() {
            const [status, setStatus] = useState("Idle");
            const [mobile, setMobile] = useState("");
            const [pass, setPass] = useState("");

            const handleLogin = async () => {
                if (!mobile) return alert("Enter Mobile Number");
                
                setStatus("Connecting...");
                addLog(`Attempting login for: ${mobile}...`);

                // 1. TIMEOUT CHECK (Agar 10 sec mein na ho)
                const timer = setTimeout(() => {
                    setStatus("Timed Out");
                    addLog("âŒ Error: Connection Timed Out. Internet ya Firebase Blocked hai.", "error");
                    alert("Timeout! Check internet or Firebase Console settings.");
                }, 10000);

                try {
                    // 2. AUTHENTICATION
                    const userCred = await signInAnonymously(auth);
                    clearTimeout(timer);
                    addLog(`âœ… Auth Success! UID: ${userCred.user.uid}`);
                    
                    // 3. DATABASE CHECK
                    setStatus("Checking DB...");
                    const ref = doc(db, 'debug_users', userCred.user.uid);
                    await setDoc(ref, { lastLogin: new Date().toISOString(), mobile: mobile });
                    addLog("âœ… Database Write Success! You are fully connected.");
                    
                    setStatus("SUCCESS!");
                    alert("LOGIN SUCCESSFUL! (Ab aap asli code use kar sakte hain)");

                } catch (e) {
                    clearTimeout(timer);
                    setStatus("Failed");
                    addLog(`âŒ ERROR: ${e.code} - ${e.message}`, "error");
                    
                    if (e.code === 'auth/operation-not-allowed') {
                        alert("FIX: Firebase Console -> Authentication -> Enable Anonymous Sign-in");
                    } else if (e.code === 'auth/unauthorized-domain') {
                        alert("FIX: Firebase Console -> Authentication -> Settings -> Add Domain (Apni website ka link add karo)");
                    } else {
                        alert("Error: " + e.message);
                    }
                }
            };

            return React.createElement('div', {className: "p-6 max-w-md mx-auto"},
                React.createElement('h1', {className: "text-2xl font-bold mb-4 text-cyan-400"}, "CONNECTION DIAGNOSTIC"),
                
                React.createElement('div', {className: "bg-slate-900 p-4 rounded-xl border border-slate-700 mb-6"},
                    React.createElement('input', {
                        placeholder: "Mobile Number", 
                        onChange: e=>setMobile(e.target.value),
                        className: "w-full bg-black p-3 rounded mb-3 text-white border border-gray-700"
                    }),
                    React.createElement('input', {
                        placeholder: "Password (Any)", 
                        type: "password",
                        onChange: e=>setPass(e.target.value),
                        className: "w-full bg-black p-3 rounded mb-3 text-white border border-gray-700"
                    }),
                    React.createElement('button', {
                        onClick: handleLogin,
                        className: "w-full bg-blue-600 py-3 rounded font-bold text-white hover:bg-blue-500"
                    }, status === "Connecting..." ? "CONNECTING..." : "TEST LOGIN")
                ),

                React.createElement('div', {className: "mb-2 text-xs text-gray-400 uppercase"}, "Live System Logs:"),
                React.createElement('div', {
                    id: "log-box",
                    className: "bg-black p-4 rounded h-64 overflow-y-auto text-xs font-mono text-green-400 border border-green-900"
                }, "Waiting for action...")
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>


